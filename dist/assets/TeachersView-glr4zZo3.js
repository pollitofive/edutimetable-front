import{d as Le,Y as De,Z as N,r as h,$ as Me,a0 as Z,c as M,N as le,i as m,o as c,k as l,j as a,x as n,e,w as s,B as d,n as p,E as C,v as g,C as q,a as x,F as U,p as J,I as Se,a1 as Fe,s as j,a2 as E,a4 as Ae,a5 as Ue,a6 as Re,a7 as Ve}from"./index-D2oXT1xy.js";import{_ as oe}from"./FormLabel.vue_vue_type_script_setup_true_lang-DPKPgNkB.js";import{T as v,P as $}from"./index-CBE7LNRt.js";const S=R=>(Ue("data-v-a22dd38e"),R=R(),Re(),R),Be={class:"flex flex-col gap-y-3 md:h-10 md:flex-row md:items-center"},Ne={class:"text-base font-medium"},qe={class:"flex flex-col gap-x-3 gap-y-2 sm:flex-row md:ml-auto"},je={class:"box box--stacked flex flex-col mt-5"},He={class:"p-5 border-b border-slate-200/60"},ze={class:"flex flex-col gap-4 sm:flex-row sm:items-center"},Ge={class:"flex-1"},Oe={class:"relative"},Qe={class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},Xe={class:"flex-1"},Ye={class:"relative"},Ze={class:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none"},Je={key:0,class:"flex items-center justify-center p-10"},Ke={class:"flex flex-col items-center gap-3"},We={class:"text-sm text-slate-500"},ea={key:1,class:"flex items-center justify-center p-10"},aa={class:"flex flex-col items-center gap-3"},ta={class:"text-sm text-slate-500"},sa={key:2,class:"overflow-x-auto"},la={class:"flex flex-col items-center gap-3"},oa={class:"font-medium"},na={class:"text-slate-500"},ra={key:0,class:"flex flex-wrap gap-1"},ia={key:0,class:"px-2 py-0.5 text-xs rounded-md bg-slate-100 text-slate-500"},ca={key:1,class:"text-xs text-slate-400"},da={class:"flex items-center justify-center gap-2"},ua={key:3,class:"flex flex-col items-center gap-4 p-5 border-t sm:flex-row border-slate-200/60"},ma={class:"flex items-center gap-2"},va={class:"text-sm text-slate-600"},ha=S(()=>l("option",{value:10},"10",-1)),fa=S(()=>l("option",{value:25},"25",-1)),pa=S(()=>l("option",{value:50},"50",-1)),_a=S(()=>l("option",{value:100},"100",-1)),ga=[ha,fa,pa,_a],xa={class:"text-sm text-slate-600"},ya={class:"text-sm text-slate-600 sm:ml-auto"},ka={class:"mr-auto text-base font-medium"},ba={class:"col-span-12"},Ta={key:0,class:"mt-1 text-xs text-danger"},wa={class:"col-span-12"},Ca={key:0,class:"mt-1 text-xs text-danger"},$a={key:1},Ea={class:"p-5 text-center"},Ia={class:"mt-5 text-3xl"},Pa={class:"mt-2 text-slate-500"},La=S(()=>l("br",null,null,-1)),Da={class:"font-medium"},Ma=S(()=>l("br",null,null,-1)),Sa={class:"px-5 pb-8 text-center"},Fa={key:1},Aa=Le({__name:"TeachersView",setup(R){const{t}=De(),ne=N`
  query GetTeachers($first: Int!, $page: Int!, $name: String, $email: String) {
    teachers(first: $first, page: $page, name: $name, email: $email) {
      data {
        id
        name
        email
        courses {
          id
          name
          courseLevel {
            name
            track
          }
        }
      }
      paginatorInfo {
        total
        count
        currentPage
        lastPage
        hasMorePages
        perPage
      }
    }
  }
`,re=N`
  mutation CreateTeacher($input: CreateTeacherInput!) {
    createTeacher(input: $input) {
      id
      name
      email
    }
  }
`,ie=N`
  mutation UpdateTeacher($id: ID!, $input: UpdateTeacherInput!) {
    updateTeacher(id: $id, input: $input) {
      id
      name
      email
    }
  }
`,ce=N`
  mutation DeleteTeacher($id: ID!) {
    deleteTeacher(id: $id) {
      id
    }
  }
`,H=h([]),V=h(!1),I=h(null),_=h({name:"",email:""}),f=h({}),B=h(!1),P=h(null),z=h(!1),K=h(""),W=h("success"),u=h(1),y=h(10),L=h(0),G=h(1),k=h(""),b=h("");let O=null;const{result:de,loading:ee,error:ae,refetch:D}=Me(ne,()=>({first:y.value,page:u.value,name:k.value?`%${k.value}%`:void 0,email:b.value?`%${b.value}%`:void 0}),{fetchPolicy:"cache-and-network"}),{mutate:ue,loading:me}=Z(re),{mutate:ve,loading:he}=Z(ie),{mutate:fe,loading:Q}=Z(ce),X=M(()=>me.value||he.value),pe=M(()=>I.value?t("teachers.editTeacher"):t("teachers.newTeacher")),_e=M(()=>L.value===0?0:(u.value-1)*y.value+1),ge=M(()=>{const r=u.value*y.value;return r>L.value?L.value:r}),T=M(()=>G.value);le(de,r=>{var i,o;if((i=r==null?void 0:r.teachers)!=null&&i.data&&(H.value=r.teachers.data),(o=r==null?void 0:r.teachers)!=null&&o.paginatorInfo){const w=r.teachers.paginatorInfo;L.value=w.total,G.value=w.lastPage,u.value=w.currentPage}});const F=(r,i="success")=>{K.value=r,W.value=i,z.value=!0},xe=()=>{z.value=!1},ye=()=>(f.value={},_.value.name.trim()||(f.value.name=t("teachers.validation.nameRequired")),_.value.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(_.value.email)||(f.value.email=t("teachers.validation.emailInvalid")):f.value.email=t("teachers.validation.emailRequired"),Object.keys(f.value).length===0),ke=()=>{I.value=null,_.value={name:"",email:""},f.value={},V.value=!0},be=r=>{I.value=r,_.value={name:r.name,email:r.email},f.value={},V.value=!0},Y=()=>{V.value=!1,I.value=null,_.value={name:"",email:""},f.value={}},Te=async()=>{if(ye())try{I.value?(await ve({id:I.value.id,input:_.value}),F(t("teachers.messages.updateSuccess"),"success")):(await ue({input:_.value}),F(t("teachers.messages.createSuccess"),"success")),Y(),D()}catch(r){const i=r.message||t("teachers.messages.generalError");F(i,"error"),console.error("Error saving teacher:",r)}},we=r=>{P.value=r,B.value=!0},Ce=async()=>{if(P.value)try{await fe({id:P.value.id}),F(t("teachers.messages.deleteSuccess"),"success"),B.value=!1,P.value=null,D()}catch(r){const i=r.message||t("teachers.messages.deleteError");F(i,"error"),console.error("Error deleting teacher:",r)}},te=()=>{B.value=!1,P.value=null},A=r=>{r>=1&&r<=G.value&&(u.value=r,D({first:y.value,page:r}))},$e=r=>{y.value=r,u.value=1,D({first:r,page:1})},se=()=>{u.value=1;const r={first:y.value,page:1};k.value.trim()&&(r.name=`%${k.value}%`),b.value.trim()&&(r.email=`%${b.value}%`),D(r)},Ee=()=>{O&&clearTimeout(O),O=setTimeout(()=>{se()},500)},Ie=()=>{k.value="",b.value="",se()},Pe=M(()=>k.value.trim()!==""||b.value.trim()!=="");return le([k,b],()=>{Ee()}),(r,i)=>(c(),m(U,null,[l("div",Be,[l("div",Ne,n(e(t)("teachers.title")),1),l("div",qe,[a(e(C),{variant:"primary",onClick:ke},{default:s(()=>[a(e(p),{icon:"Plus",class:"w-4 h-4 mr-2"}),d(" "+n(e(t)("teachers.newTeacher")),1)]),_:1})])]),l("div",je,[l("div",He,[l("div",ze,[l("div",Ge,[l("div",Oe,[l("div",Qe,[a(e(p),{icon:"Search",class:"w-4 h-4 text-slate-400"})]),a(e(q),{modelValue:k.value,"onUpdate:modelValue":i[0]||(i[0]=o=>k.value=o),type:"text",placeholder:e(t)("teachers.filters.searchByName"),class:"pl-10"},null,8,["modelValue","placeholder"])])]),l("div",Xe,[l("div",Ye,[l("div",Ze,[a(e(p),{icon:"Mail",class:"w-4 h-4 text-slate-400"})]),a(e(q),{modelValue:b.value,"onUpdate:modelValue":i[1]||(i[1]=o=>b.value=o),type:"text",placeholder:e(t)("teachers.filters.searchByEmail"),class:"pl-10"},null,8,["modelValue","placeholder"])])]),l("div",null,[Pe.value?(c(),x(e(C),{key:0,variant:"outline-secondary",onClick:Ie,class:"w-full sm:w-auto"},{default:s(()=>[a(e(p),{icon:"X",class:"w-4 h-4 mr-2"}),d(" "+n(e(t)("teachers.actions.clearFilters")),1)]),_:1})):g("",!0)])])]),e(ee)?(c(),m("div",Je,[l("div",Ke,[a(e(p),{icon:"Loader",class:"w-8 h-8 animate-spin text-primary"}),l("div",We,n(e(t)("teachers.messages.loading")),1)])])):e(ae)?(c(),m("div",ea,[l("div",aa,[a(e(p),{icon:"AlertCircle",class:"w-8 h-8 text-danger"}),l("div",ta,n(e(t)("teachers.messages.error")),1),a(e(C),{variant:"outline-primary",onClick:i[2]||(i[2]=()=>e(D)())},{default:s(()=>[d(n(e(t)("teachers.actions.retry")),1)]),_:1})])])):(c(),m("div",sa,[a(e(v),{class:"border-b border-slate-200/60"},{default:s(()=>[a(e(v).Thead,null,{default:s(()=>[a(e(v).Tr,null,{default:s(()=>[a(e(v).Td,{class:"py-4 font-medium bg-slate-50 dark:bg-darkmode-800 text-slate-500 border-slate-200/60 whitespace-nowrap"},{default:s(()=>[d(n(e(t)("teachers.columns.id")),1)]),_:1}),a(e(v).Td,{class:"py-4 font-medium bg-slate-50 dark:bg-darkmode-800 text-slate-500 border-slate-200/60 whitespace-nowrap"},{default:s(()=>[d(n(e(t)("teachers.columns.name")),1)]),_:1}),a(e(v).Td,{class:"py-4 font-medium bg-slate-50 dark:bg-darkmode-800 text-slate-500 border-slate-200/60 whitespace-nowrap"},{default:s(()=>[d(n(e(t)("teachers.columns.email")),1)]),_:1}),a(e(v).Td,{class:"py-4 font-medium bg-slate-50 dark:bg-darkmode-800 text-slate-500 border-slate-200/60 whitespace-nowrap"},{default:s(()=>[d(n(e(t)("teachers.columns.courses")),1)]),_:1}),a(e(v).Td,{class:"py-4 font-medium text-center bg-slate-50 dark:bg-darkmode-800 text-slate-500 border-slate-200/60 whitespace-nowrap"},{default:s(()=>[d(n(e(t)("teachers.columns.actions")),1)]),_:1})]),_:1})]),_:1}),a(e(v).Tbody,null,{default:s(()=>[H.value.length===0?(c(),x(e(v).Tr,{key:0},{default:s(()=>[a(e(v).Td,{colspan:"5",class:"py-10 text-center text-slate-500"},{default:s(()=>[l("div",la,[a(e(p),{icon:"Inbox",class:"w-10 h-10 text-slate-300"}),l("div",null,n(e(t)("teachers.messages.noTeachers")),1)])]),_:1})]),_:1})):g("",!0),(c(!0),m(U,null,J(H.value,o=>(c(),x(e(v).Tr,{key:o.id,class:"[&_td]:last:border-b-0"},{default:s(()=>[a(e(v).Td,{class:"py-4 border-dashed dark:bg-darkmode-600"},{default:s(()=>[d(n(o.id),1)]),_:2},1024),a(e(v).Td,{class:"py-4 border-dashed dark:bg-darkmode-600"},{default:s(()=>[l("div",oa,n(o.name),1)]),_:2},1024),a(e(v).Td,{class:"py-4 border-dashed dark:bg-darkmode-600"},{default:s(()=>[l("div",na,n(o.email),1)]),_:2},1024),a(e(v).Td,{class:"py-4 border-dashed dark:bg-darkmode-600"},{default:s(()=>[o.courses&&o.courses.length>0?(c(),m("div",ra,[(c(!0),m(U,null,J(o.courses.slice(0,3),w=>(c(),m("span",{key:w.id,class:"px-2 py-0.5 text-xs rounded-md bg-primary/10 text-primary"},n(w.name),1))),128)),o.courses.length>3?(c(),m("span",ia,n(e(t)("teachers.messages.moreItems",{count:o.courses.length-3})),1)):g("",!0)])):(c(),m("div",ca,n(e(t)("teachers.messages.noCourses")),1))]),_:2},1024),a(e(v).Td,{class:"relative py-4 border-dashed dark:bg-darkmode-600"},{default:s(()=>[l("div",da,[a(e(C),{variant:"outline-secondary",size:"sm",onClick:w=>be(o),class:"w-20"},{default:s(()=>[a(e(p),{icon:"Edit",class:"w-3.5 h-3.5 mr-1"}),d(" "+n(e(t)("teachers.actions.edit")),1)]),_:2},1032,["onClick"]),a(e(C),{variant:"outline-danger",size:"sm",onClick:w=>we(o),class:"w-20"},{default:s(()=>[a(e(p),{icon:"Trash2",class:"w-3.5 h-3.5 mr-1"}),d(" "+n(e(t)("teachers.actions.delete")),1)]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])),!e(ee)&&!e(ae)&&L.value>0?(c(),m("div",ua,[l("div",ma,[l("span",va,n(e(t)("teachers.pagination.show")),1),Se(l("select",{"onUpdate:modelValue":i[3]||(i[3]=o=>y.value=o),onChange:i[4]||(i[4]=o=>$e(y.value)),class:"px-3 py-2 text-sm border rounded-md border-slate-300 dark:border-darkmode-400 dark:bg-darkmode-800 focus:ring-2 focus:ring-primary focus:border-primary"},ga,544),[[Fe,y.value,void 0,{number:!0}]]),l("span",xa,n(e(t)("teachers.pagination.entries")),1)]),l("div",ya,n(e(t)("teachers.pagination.showingInfo",{start:_e.value,end:ge.value,total:L.value})),1),a(e($),{class:"flex-1 sm:flex-initial"},{default:s(()=>[a(e($).Link,{onClick:i[5]||(i[5]=o=>A(u.value-1)),class:j({"cursor-not-allowed opacity-50":u.value===1})},{default:s(()=>[a(e(p),{icon:"ChevronLeft",class:"w-4 h-4"})]),_:1},8,["class"]),T.value>0?(c(),x(e($).Link,{key:0,active:u.value===1,onClick:i[6]||(i[6]=o=>A(1))},{default:s(()=>[d(" 1 ")]),_:1},8,["active"])):g("",!0),u.value>3?(c(),x(e($).Link,{key:1,disabled:""},{default:s(()=>[d(" ... ")]),_:1})):g("",!0),(c(!0),m(U,null,J(T.value,o=>(c(),m(U,{key:o},[o>1&&o<T.value&&Math.abs(o-u.value)<=1?(c(),x(e($).Link,{key:0,active:u.value===o,onClick:w=>A(o)},{default:s(()=>[d(n(o),1)]),_:2},1032,["active","onClick"])):g("",!0)],64))),128)),u.value<T.value-2?(c(),x(e($).Link,{key:2,disabled:""},{default:s(()=>[d(" ... ")]),_:1})):g("",!0),T.value>1?(c(),x(e($).Link,{key:3,active:u.value===T.value,onClick:i[7]||(i[7]=o=>A(T.value))},{default:s(()=>[d(n(T.value),1)]),_:1},8,["active"])):g("",!0),a(e($).Link,{onClick:i[8]||(i[8]=o=>A(u.value+1)),class:j({"cursor-not-allowed opacity-50":u.value===T.value})},{default:s(()=>[a(e(p),{icon:"ChevronRight",class:"w-4 h-4"})]),_:1},8,["class"])]),_:1})])):g("",!0)]),a(e(E),{open:V.value,onClose:Y},{default:s(()=>[a(e(E).Panel,null,{default:s(()=>[a(e(E).Title,null,{default:s(()=>[l("h2",ka,n(pe.value),1)]),_:1}),a(e(E).Description,{class:"grid grid-cols-12 gap-4 gap-y-3"},{default:s(()=>[l("div",ba,[a(e(oe),{htmlFor:"teacher-name"},{default:s(()=>[d(n(e(t)("teachers.form.nameLabel"))+" "+n(e(t)("teachers.form.required")),1)]),_:1}),a(e(q),{id:"teacher-name",modelValue:_.value.name,"onUpdate:modelValue":i[9]||(i[9]=o=>_.value.name=o),type:"text",placeholder:e(t)("teachers.form.namePlaceholder"),class:j({"border-danger":f.value.name})},null,8,["modelValue","placeholder","class"]),f.value.name?(c(),m("div",Ta,n(f.value.name),1)):g("",!0)]),l("div",wa,[a(e(oe),{htmlFor:"teacher-email"},{default:s(()=>[d(n(e(t)("teachers.form.emailLabel"))+" "+n(e(t)("teachers.form.required")),1)]),_:1}),a(e(q),{id:"teacher-email",modelValue:_.value.email,"onUpdate:modelValue":i[10]||(i[10]=o=>_.value.email=o),type:"email",placeholder:e(t)("teachers.form.emailPlaceholder"),class:j({"border-danger":f.value.email})},null,8,["modelValue","placeholder","class"]),f.value.email?(c(),m("div",Ca,n(f.value.email),1)):g("",!0)])]),_:1}),a(e(E).Footer,{class:"text-right"},{default:s(()=>[a(e(C),{type:"button",variant:"outline-secondary",onClick:Y,disabled:X.value,class:"w-20 mr-2"},{default:s(()=>[d(n(e(t)("teachers.actions.cancel")),1)]),_:1},8,["disabled"]),a(e(C),{type:"button",variant:"primary",onClick:Te,disabled:X.value,class:"w-20"},{default:s(()=>[X.value?(c(),x(e(p),{key:0,icon:"Loader",class:"w-4 h-4 animate-spin"})):(c(),m("span",$a,n(e(t)("teachers.actions.save")),1))]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),a(e(E),{open:B.value,onClose:te},{default:s(()=>[a(e(E).Panel,null,{default:s(()=>{var o;return[l("div",Ea,[a(e(p),{icon:"AlertTriangle",class:"w-16 h-16 mx-auto mt-3 text-danger"}),l("div",Ia,n(e(t)("teachers.delete.confirmTitle")),1),l("div",Pa,[d(n(e(t)("teachers.delete.confirmMessage"))+" ",1),La,l("span",Da,n((o=P.value)==null?void 0:o.name),1),Ma,d(" "+n(e(t)("teachers.delete.cannotUndo")),1)])]),l("div",Sa,[a(e(C),{type:"button",variant:"outline-secondary",onClick:te,disabled:e(Q),class:"w-24 mr-2"},{default:s(()=>[d(n(e(t)("teachers.actions.cancel")),1)]),_:1},8,["disabled"]),a(e(C),{type:"button",variant:"danger",onClick:Ce,disabled:e(Q),class:"w-24"},{default:s(()=>[e(Q)?(c(),x(e(p),{key:0,icon:"Loader",class:"w-4 h-4 animate-spin"})):(c(),m("span",Fa,n(e(t)("teachers.actions.delete")),1))]),_:1},8,["disabled"])])]}),_:1})]),_:1},8,["open"]),a(Ae,{show:z.value,message:K.value,type:W.value,onClose:xe},null,8,["show","message","type"])],64))}}),Ba=Ve(Aa,[["__scopeId","data-v-a22dd38e"]]);export{Ba as default};
