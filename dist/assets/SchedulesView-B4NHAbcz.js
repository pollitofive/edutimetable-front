import{d as Ss,Y as Ts,Z as R,r as p,c as P,$ as be,a8 as $s,a0 as ce,N as ne,i as _,o as c,k as u,j as r,x as d,e,w as i,B as h,n as C,E as T,v as k,F,p as M,C as te,a as $,s as b,I as Es,a1 as Is,a2 as H,a4 as Us,a5 as Ls,a6 as Ds,a7 as Vs}from"./index-D2oXT1xy.js";import{_ as Q}from"./FormLabel.vue_vue_type_script_setup_true_lang-DPKPgNkB.js";import{_ as _e}from"./FormSelect.vue_vue_type_script_setup_true_lang-B1PIZPoQ.js";import{T as f,P as B}from"./index-CBE7LNRt.js";import{_ as Ne}from"./TomSelect.vue_vue_type_script_setup_true_lang-BO1vyfpz.js";const oe=de=>(Ls("data-v-0b5c0419"),de=de(),Ds(),de),Ps={class:"w-full"},Fs={class:"flex flex-col gap-y-3 md:h-10 md:flex-row md:items-center"},As={class:"text-base font-medium"},Ns={class:"flex flex-col gap-x-3 gap-y-2 sm:flex-row md:ml-auto"},Ms={class:"box box--stacked flex flex-col mt-5 w-full"},Bs={class:"p-5 border-b border-slate-200/60"},Os={class:"flex flex-col gap-4"},Gs={class:"flex flex-col gap-4 sm:flex-row sm:items-center"},js={class:"flex-1"},qs={value:""},zs=["value"],Rs={class:"flex-1"},Hs={value:""},Qs=["value"],Ws={class:"flex-1"},Ks={value:""},Ys={value:"0"},Js={value:"1"},Xs={value:"2"},Zs={value:"3"},et={value:"4"},st={value:"5"},tt={value:"6"},at={class:"flex flex-col gap-4 sm:flex-row sm:items-center"},lt={class:"flex-1"},ot={class:"flex-1 sm:flex-[0.5]"},dt={class:"flex-1 sm:flex-[0.5]"},rt={key:0,class:"flex items-center justify-center p-10"},ut={class:"flex flex-col items-center gap-3"},it={class:"text-sm text-slate-500"},ct={key:1,class:"flex items-center justify-center p-10"},nt={class:"flex flex-col items-center gap-3"},_t={class:"text-sm text-slate-500"},vt={key:2,class:"overflow-x-auto"},ht={class:"flex flex-col items-center gap-3"},mt={class:"text-xs text-slate-500"},pt={key:0,class:"font-medium text-slate-700 dark:text-slate-200"},ft={key:1,class:"text-slate-400 dark:text-slate-500 text-sm"},yt={class:"text-slate-600 dark:text-slate-300"},gt={class:"px-2 py-1 text-xs font-medium rounded-md bg-primary/10 text-primary inline-block"},kt={class:"font-mono text-slate-600 dark:text-slate-300"},bt={class:"font-mono text-slate-600 dark:text-slate-300"},xt={class:"font-mono text-slate-600 dark:text-slate-300"},wt={class:"flex items-center justify-center gap-2"},Ct={key:1,class:"w-24"},St={key:3,class:"flex flex-col items-center gap-4 p-5 border-t sm:flex-row border-slate-200/60"},Tt={class:"flex items-center gap-2"},$t={class:"text-sm text-slate-600"},Et=oe(()=>u("option",{value:10},"10",-1)),It=oe(()=>u("option",{value:25},"25",-1)),Ut=oe(()=>u("option",{value:50},"50",-1)),Lt=oe(()=>u("option",{value:100},"100",-1)),Dt=[Et,It,Ut,Lt],Vt={class:"text-sm text-slate-600"},Pt={class:"text-sm text-slate-600 sm:ml-auto"},Ft={class:"mr-auto text-base font-medium"},At={class:"col-span-12"},Nt={value:""},Mt=["value"],Bt={key:0,class:"mt-1 text-xs text-danger"},Ot={class:"col-span-12"},Gt={key:0,class:"mt-1 text-xs text-danger"},jt={key:0,class:"col-span-12 flex items-center justify-center py-8"},qt={class:"flex flex-col items-center gap-3"},zt={class:"text-sm text-slate-500"},Rt={key:1,class:"col-span-12"},Ht={class:"flex items-center justify-between mb-3"},Qt={class:"max-h-80 overflow-y-auto pr-2 space-y-3 scroll-smooth border border-slate-200/60 rounded-lg p-3 dark:border-darkmode-400"},Wt={class:"flex items-center justify-between mb-3"},Kt={class:"flex items-center gap-2"},Yt={class:"flex items-center justify-center w-7 h-7 rounded-full bg-primary/10 text-primary font-semibold text-sm"},Jt={class:"text-sm font-medium text-slate-700 dark:text-slate-300"},Xt={class:"grid grid-cols-12 gap-3"},Zt={class:"col-span-12"},ea={value:""},sa=["value"],ta={key:0,class:"mt-1 text-xs text-danger"},aa={class:"col-span-12 sm:col-span-4"},la={value:""},oa=["value"],da={key:0,class:"mt-1 text-xs text-danger"},ra={class:"col-span-12 sm:col-span-4"},ua={key:0,class:"mt-1 text-xs text-danger"},ia={class:"col-span-12 sm:col-span-4"},ca={key:0,class:"mt-1 text-xs text-danger"},na={key:0,class:"mt-3"},_a={key:1},va={key:2},ha={key:3},ma={class:"p-5 text-center"},pa={class:"mt-5 text-3xl"},fa={class:"mt-2 text-slate-500"},ya=oe(()=>u("br",null,null,-1)),ga={class:"px-5 pb-8 text-center"},ka={key:1},ba=Ss({__name:"SchedulesView",setup(de){const{t:a}=Ts(),xe=R`
  query GetSchedules($first: Int!, $page: Int!, $course_id: ID, $day_of_week: Int, $teacher_id: ID, $description: String, $group_id: String, $starts_at_from: String, $starts_at_to: String) {
    schedules(first: $first, page: $page, course_id: $course_id, day_of_week: $day_of_week, teacher_id: $teacher_id, description: $description, group_id: $group_id, starts_at_from: $starts_at_from, starts_at_to: $starts_at_to) {
      data {
        id
        course_id
        teacher_id
        day_of_week
        starts_at
        ends_at
        description
        group_id
        course {
          id
          name
        }
        teacher {
          id
          name
        }
      }
      paginatorInfo {
        total
        count
        currentPage
        lastPage
        hasMorePages
        perPage
      }
    }
  }
`,Me=R`
  query GetAllCourses {
    courses(first: 10000) {
      data {
        id
        name
      }
    }
  }
`,Be=R`
  query GetAllTeachers {
    teachers(first: 10000) {
      data {
        id
        name
      }
    }
  }
`,Oe=R`
  mutation BulkCreateSchedules($input: BulkCreateSchedulesInput!) {
    bulkCreateSchedules(input: $input) {
      id
      course_id
      teacher_id
      day_of_week
      starts_at
      ends_at
      description
      group_id
      course {
        id
        name
      }
      teacher {
        id
        name
      }
    }
  }
`,Ge=R`
  mutation BulkUpdateSchedules($input: BulkUpdateSchedulesInput!) {
    bulkUpdateSchedules(input: $input) {
      id
      course_id
      teacher_id
      day_of_week
      starts_at
      ends_at
      description
      group_id
      course {
        id
        name
      }
      teacher {
        id
        name
      }
    }
  }
`,je=R`
  mutation UpdateSchedule($id: ID!, $input: UpdateScheduleInput!) {
    updateSchedule(id: $id, input: $input) {
      id
      course_id
      teacher_id
      day_of_week
      starts_at
      ends_at
      description
      group_id
      course {
        id
        name
      }
      teacher {
        id
        name
      }
    }
  }
`,qe=R`
  mutation DeleteSchedule($id: ID!) {
    deleteSchedule(id: $id) {
      id
    }
  }
`,re=p([]),ue=p([]),ve=p([]),ae=p(!1),A=p(!1),I=p(!1),he=p(null),n=p({course_id:"",description:"",schedules:[{teacher_id:"",day_of_week:"",starts_at:"",ends_at:""}]}),v=p({}),ie=p(!1),W=p(null),me=p(!1),we=p(""),Ce=p("success"),g=p(1),O=p(10),K=p(0),pe=p(1),Y=p(""),G=p(""),J=p(""),j=p(""),X=p(""),Z=p(""),ze=P(()=>({first:O.value,page:g.value,course_id:Y.value||void 0,day_of_week:G.value?Number(G.value):void 0,teacher_id:J.value||void 0,description:j.value?`%${j.value}%`:void 0,group_id:void 0,starts_at_from:X.value||void 0,starts_at_to:Z.value||void 0})),{result:Re,loading:Se,error:Te,refetch:He}=be(xe,ze,{fetchPolicy:"cache-and-network"}),{result:Qe}=be(Me),{result:We}=be(Be),{load:Ke,refetch:Ye,loading:ee}=$s(xe,{fetchPolicy:"network-only"}),$e=p(!1),{mutate:Je,loading:Xe}=ce(Oe),{mutate:Ze,loading:es}=ce(Ge),{mutate:ss,loading:ts}=ce(je),{mutate:as,loading:fe}=ce(qe),ye=P(()=>Xe.value||es.value||ts.value),ls=P(()=>{var t;if(I.value)return a("schedules.form.editSingleTitle");if(A.value){const l=((t=ue.value.find(s=>s.id===n.value.course_id))==null?void 0:t.name)||"";return a("schedules.form.editTitle",{course:l})}return a("schedules.form.addTitle")}),os=P(()=>K.value===0?0:(g.value-1)*O.value+1),ds=P(()=>{const t=g.value*O.value;return t>K.value?K.value:t}),D=P(()=>pe.value),rs=t=>[a("schedules.days.sunday"),a("schedules.days.monday"),a("schedules.days.tuesday"),a("schedules.days.wednesday"),a("schedules.days.thursday"),a("schedules.days.friday"),a("schedules.days.saturday")][t]||"",us=P(()=>[{value:0,label:a("schedules.days.sunday")},{value:1,label:a("schedules.days.monday")},{value:2,label:a("schedules.days.tuesday")},{value:3,label:a("schedules.days.wednesday")},{value:4,label:a("schedules.days.thursday")},{value:5,label:a("schedules.days.friday")},{value:6,label:a("schedules.days.saturday")}]),q=P(()=>!re.value||re.value.length===0?[]:[...re.value].sort((t,l)=>{var U,x,y,L;const s=(((U=t.course)==null?void 0:U.name)||"").localeCompare(((x=l.course)==null?void 0:x.name)||"");if(s!==0)return s;const o=(((y=t.teacher)==null?void 0:y.name)||"").localeCompare(((L=l.teacher)==null?void 0:L.name)||"");if(o!==0)return o;const m=(t.group_id||"").localeCompare(l.group_id||"");if(m!==0)return m;const S=(t.day_of_week||0)-(l.day_of_week||0);return S!==0?S:(t.starts_at||"").localeCompare(l.starts_at||"")}));ne(Re,t=>{var l,s;if((l=t==null?void 0:t.schedules)!=null&&l.data&&(re.value=t.schedules.data),(s=t==null?void 0:t.schedules)!=null&&s.paginatorInfo){const o=t.schedules.paginatorInfo;K.value=o.total,pe.value=o.lastPage,g.value=o.currentPage}}),ne(Qe,t=>{var l;(l=t==null?void 0:t.courses)!=null&&l.data&&(ue.value=[...t.courses.data].sort((s,o)=>s.name.localeCompare(o.name)))},{immediate:!0}),ne(We,t=>{var l;(l=t==null?void 0:t.teachers)!=null&&l.data&&(ve.value=[...t.teachers.data].sort((s,o)=>s.name.localeCompare(o.name)))},{immediate:!0});const E=(t,l="success")=>{we.value=t,Ce.value=l,me.value=!0},se=t=>{if(!t)return t;const l=t.split(":");return l.length>=2?`${l[0]}:${l[1]}`:t},is=()=>{me.value=!1},cs=()=>{const t=n.value.schedules[n.value.schedules.length-1];n.value.schedules.push({teacher_id:(t==null?void 0:t.teacher_id)||"",day_of_week:(t==null?void 0:t.day_of_week)||"",starts_at:(t==null?void 0:t.starts_at)||"",ends_at:(t==null?void 0:t.ends_at)||""})},ns=t=>{n.value.schedules.length>1&&(n.value.schedules.splice(t,1),v.value.schedules&&v.value.schedules[t]&&v.value.schedules.splice(t,1))},_s=()=>{if(v.value={schedules:[]},n.value.course_id||(v.value.course_id=a("schedules.validation.courseRequired")),(!n.value.description||!n.value.description.trim())&&(v.value.description=a("schedules.validation.descriptionRequired")),n.value.schedules.length===0)return E(a("schedules.validation.atLeastOneSlot"),"error"),!1;let t=!1;return n.value.schedules.forEach((l,s)=>{const o={};(!l.teacher_id||!l.teacher_id.trim())&&(o.teacher_id=a("schedules.validation.teacherRequired"),t=!0),l.day_of_week===""&&(o.day_of_week=a("schedules.validation.dayRequired"),t=!0),(!l.starts_at||!l.starts_at.trim())&&(o.starts_at=a("schedules.validation.startTimeRequired"),t=!0),(!l.ends_at||!l.ends_at.trim())&&(o.ends_at=a("schedules.validation.endTimeRequired"),t=!0),l.starts_at&&l.ends_at&&l.ends_at<=l.starts_at&&(o.ends_at=a("schedules.validation.endTimeAfterStart"),t=!0),Object.keys(o).length>0&&(v.value.schedules||(v.value.schedules=[]),v.value.schedules[s]=o)}),!t&&!v.value.course_id&&!v.value.description},vs=()=>{A.value=!1,I.value=!1,n.value={course_id:"",description:"",schedules:[{teacher_id:"",day_of_week:"",starts_at:"",ends_at:""}],group_id:void 0},v.value={},ae.value=!0},hs=t=>{A.value=!1,I.value=!0,he.value=t.id,n.value={course_id:t.course_id,description:t.description||"",schedules:[{teacher_id:t.teacher_id,day_of_week:t.day_of_week,starts_at:t.starts_at,ends_at:t.ends_at}],group_id:t.group_id},v.value={},ae.value=!0},ms=async t=>{var o,m,S,U;A.value=!0,I.value=!1;const l=t.course_id,s=t.group_id;n.value={course_id:l,description:"",schedules:[],group_id:void 0},v.value={},ae.value=!0;try{const x={first:1e3,page:1};s?x.group_id=s:(x.course_id=l,t.description&&(x.description=t.description)),console.log("Fetching schedules with variables:",x);let y;$e.value?y=await Ye(x):(y=await Ke(null,x),$e.value=!0),console.log("Query result:",y),console.log("Full query result structure:",JSON.stringify(y,null,2));const L=((m=(o=y==null?void 0:y.data)==null?void 0:o.schedules)==null?void 0:m.data)||((S=y==null?void 0:y.schedules)==null?void 0:S.data);if(console.log("Extracted schedulesData:",L),L&&Array.isArray(L)){const N=L;console.log(`Found ${N.length} schedules in group`),N.length>0?(n.value.description=N[0].description||"",n.value.group_id=N[0].group_id,n.value.schedules=N.map(z=>({teacher_id:z.teacher_id,day_of_week:z.day_of_week,starts_at:z.starts_at,ends_at:z.ends_at}))):(console.warn("No schedules found for this group"),n.value.schedules=[{teacher_id:"",day_of_week:"",starts_at:"",ends_at:""}])}else console.warn("No data returned from query or data is not an array"),console.warn("queryResult?.data?.schedules:",(U=y==null?void 0:y.data)==null?void 0:U.schedules),console.warn("queryResult?.schedules:",y==null?void 0:y.schedules),n.value.schedules=[{teacher_id:"",day_of_week:"",starts_at:"",ends_at:""}]}catch(x){console.error("Error loading group schedules:",x),E(a("schedules.messages.loadError")||"Error loading schedules","error"),n.value.schedules=[{teacher_id:"",day_of_week:"",starts_at:"",ends_at:""}]}},ge=()=>{ae.value=!1,A.value=!1,I.value=!1,he.value=null,n.value={course_id:"",description:"",schedules:[{teacher_id:"",day_of_week:"",starts_at:"",ends_at:""}],group_id:void 0},v.value={}},ps=async()=>{var l,s;if(!_s())return;if(!localStorage.getItem("token")){E("You are not logged in. Please login first.","error");return}try{if(I.value){const o=n.value.schedules[0],m={course_id:n.value.course_id,teacher_id:Number(o.teacher_id),day_of_week:Number(o.day_of_week),starts_at:se(o.starts_at),ends_at:se(o.ends_at),description:n.value.description,group_id:n.value.group_id};await ss({id:he.value,input:m}),E(a("schedules.messages.updateSingleSuccess"),"success")}else if(A.value){const o={course_id:n.value.course_id,description:n.value.description,group_id:n.value.group_id,schedules:n.value.schedules.map(m=>({teacher_id:Number(m.teacher_id),day_of_week:Number(m.day_of_week),starts_at:se(m.starts_at),ends_at:se(m.ends_at)}))};await Ze({input:o}),E(a("schedules.messages.updateSuccess"),"success")}else{const o={course_id:n.value.course_id,description:n.value.description,schedules:n.value.schedules.map(m=>({teacher_id:Number(m.teacher_id),day_of_week:Number(m.day_of_week),starts_at:se(m.starts_at),ends_at:se(m.ends_at)}))};await Je({input:o}),E(a("schedules.messages.createSuccess"),"success")}ge(),ke()}catch(o){if(o.graphQLErrors&&o.graphQLErrors.length>0){const S=o.graphQLErrors[0];if(((l=S.extensions)==null?void 0:l.category)==="validation"){const U=(s=S.extensions)==null?void 0:s.validation,x=Object.values(U).flat().join(", ");E(`Validation Error: ${x}`,"error");return}if(S.message){E(S.message,"error");return}}const m=o.message||a("schedules.messages.generalError");E(m,"error")}},fs=t=>{W.value=t,ie.value=!0},ys=async()=>{if(W.value)try{await as({id:W.value.id}),E(a("schedules.messages.deleteSuccess"),"success"),ie.value=!1,W.value=null,ke()}catch(t){const l=t.message||a("schedules.messages.deleteError");E(l,"error")}},Ee=()=>{ie.value=!1,W.value=null},le=t=>{t>=1&&t<=pe.value&&(g.value=t)},gs=t=>{O.value=t,g.value=1},ke=()=>{g.value=1},ks=()=>{Y.value="",G.value="",J.value="",j.value="",X.value="",Z.value="",ke()},bs=P(()=>Y.value!==""||G.value!==""||J.value!==""||j.value!==""||X.value!==""||Z.value!=="");ne([Y,G,J,j,X,Z],()=>{g.value=1});const xs=(t,l)=>{if(t.group_id){const o=q.value.findIndex(m=>m.group_id===t.group_id);return l===o}const s=q.value.findIndex(o=>o.course_id===t.course_id&&o.description===t.description);return l===s},ws=(t,l)=>{var o;return l===0?!0:((o=q.value[l-1])==null?void 0:o.course_id)!==t},Cs=(t,l)=>{var o;return l===0?!0:((o=q.value[l-1])==null?void 0:o.course_id)!==t},V=t=>[...new Set(q.value.map(o=>o.course_id))].indexOf(t)%2===0?"bg-white dark:bg-darkmode-600":"bg-slate-50/50 dark:bg-darkmode-700";return(t,l)=>(c(),_("div",Ps,[u("div",Fs,[u("div",As,d(e(a)("schedules.title")),1),u("div",Ns,[r(e(T),{variant:"primary",onClick:vs},{default:i(()=>[r(e(C),{icon:"Plus",class:"w-4 h-4 mr-2"}),h(" "+d(e(a)("schedules.actions.new")),1)]),_:1})])]),u("div",Ms,[u("div",Bs,[u("div",Os,[u("div",Gs,[u("div",js,[r(e(Ne),{modelValue:Y.value,"onUpdate:modelValue":l[0]||(l[0]=s=>Y.value=s),options:{placeholder:e(a)("schedules.filters.allCourses"),allowEmptyOption:!0,create:!1},class:"w-full"},{default:i(()=>[u("option",qs,d(e(a)("schedules.filters.allCourses")),1),(c(!0),_(F,null,M(ue.value,s=>(c(),_("option",{key:s.id,value:s.id},d(s.name),9,zs))),128))]),_:1},8,["modelValue","options"])]),u("div",Rs,[r(e(Ne),{modelValue:J.value,"onUpdate:modelValue":l[1]||(l[1]=s=>J.value=s),options:{placeholder:e(a)("schedules.filters.allTeachers"),allowEmptyOption:!0,create:!1},class:"w-full"},{default:i(()=>[u("option",Hs,d(e(a)("schedules.filters.allTeachers")),1),(c(!0),_(F,null,M(ve.value,s=>(c(),_("option",{key:s.id,value:s.id},d(s.name),9,Qs))),128))]),_:1},8,["modelValue","options"])]),u("div",Ws,[r(e(_e),{modelValue:G.value,"onUpdate:modelValue":l[2]||(l[2]=s=>G.value=s)},{default:i(()=>[u("option",Ks,d(e(a)("schedules.filters.allDays")),1),u("option",Ys,d(e(a)("schedules.days.sunday")),1),u("option",Js,d(e(a)("schedules.days.monday")),1),u("option",Xs,d(e(a)("schedules.days.tuesday")),1),u("option",Zs,d(e(a)("schedules.days.wednesday")),1),u("option",et,d(e(a)("schedules.days.thursday")),1),u("option",st,d(e(a)("schedules.days.friday")),1),u("option",tt,d(e(a)("schedules.days.saturday")),1)]),_:1},8,["modelValue"])])]),u("div",at,[u("div",lt,[r(e(te),{modelValue:j.value,"onUpdate:modelValue":l[3]||(l[3]=s=>j.value=s),type:"text",placeholder:e(a)("schedules.filters.searchDescription")},null,8,["modelValue","placeholder"])]),u("div",ot,[r(e(te),{modelValue:X.value,"onUpdate:modelValue":l[4]||(l[4]=s=>X.value=s),type:"time",placeholder:e(a)("schedules.filters.startTime")},null,8,["modelValue","placeholder"])]),u("div",dt,[r(e(te),{modelValue:Z.value,"onUpdate:modelValue":l[5]||(l[5]=s=>Z.value=s),type:"time",placeholder:e(a)("schedules.filters.endTime")},null,8,["modelValue","placeholder"])]),u("div",null,[bs.value?(c(),$(e(T),{key:0,variant:"outline-secondary",onClick:ks,class:"w-full sm:w-auto"},{default:i(()=>[r(e(C),{icon:"X",class:"w-4 h-4 mr-2"}),h(" "+d(e(a)("schedules.actions.clearFilters")),1)]),_:1})):k("",!0)])])])]),e(Se)?(c(),_("div",rt,[u("div",ut,[r(e(C),{icon:"Loader",class:"w-8 h-8 animate-spin text-primary"}),u("div",it,d(e(a)("schedules.loading")),1)])])):e(Te)?(c(),_("div",ct,[u("div",nt,[r(e(C),{icon:"AlertCircle",class:"w-8 h-8 text-danger"}),u("div",_t,d(e(a)("schedules.messages.error")),1),r(e(T),{variant:"outline-primary",onClick:l[6]||(l[6]=()=>e(He)())},{default:i(()=>[h(d(e(a)("schedules.actions.retry")),1)]),_:1})])])):(c(),_("div",vt,[r(e(f),{class:"border-b border-slate-200/60"},{default:i(()=>[r(e(f).Thead,null,{default:i(()=>[r(e(f).Tr,null,{default:i(()=>[r(e(f).Td,{class:"py-4 font-medium bg-slate-50 dark:bg-darkmode-800 text-slate-500 border-slate-200/60 whitespace-nowrap"},{default:i(()=>[h(d(e(a)("schedules.columns.id")),1)]),_:1}),r(e(f).Td,{class:"py-4 font-medium bg-slate-50 dark:bg-darkmode-800 text-slate-500 border-slate-200/60 whitespace-nowrap"},{default:i(()=>[h(d(e(a)("schedules.columns.course")),1)]),_:1}),r(e(f).Td,{class:"py-4 font-medium bg-slate-50 dark:bg-darkmode-800 text-slate-500 border-slate-200/60 whitespace-nowrap"},{default:i(()=>[h(d(e(a)("schedules.columns.teacher")),1)]),_:1}),r(e(f).Td,{class:"py-4 font-medium bg-slate-50 dark:bg-darkmode-800 text-slate-500 border-slate-200/60 whitespace-nowrap"},{default:i(()=>[h(d(e(a)("schedules.columns.dayOfWeek")),1)]),_:1}),r(e(f).Td,{class:"py-4 font-medium bg-slate-50 dark:bg-darkmode-800 text-slate-500 border-slate-200/60 whitespace-nowrap"},{default:i(()=>[h(d(e(a)("schedules.columns.startsAt")),1)]),_:1}),r(e(f).Td,{class:"py-4 font-medium bg-slate-50 dark:bg-darkmode-800 text-slate-500 border-slate-200/60 whitespace-nowrap"},{default:i(()=>[h(d(e(a)("schedules.columns.endsAt")),1)]),_:1}),r(e(f).Td,{class:"py-4 font-medium bg-slate-50 dark:bg-darkmode-800 text-slate-500 border-slate-200/60 whitespace-nowrap"},{default:i(()=>[h(d(e(a)("schedules.columns.description")),1)]),_:1}),r(e(f).Td,{class:"py-4 font-medium text-center bg-slate-50 dark:bg-darkmode-800 text-slate-500 border-slate-200/60 whitespace-nowrap"},{default:i(()=>[h(d(e(a)("schedules.columns.actions")),1)]),_:1})]),_:1})]),_:1}),r(e(f).Tbody,null,{default:i(()=>[q.value.length===0?(c(),$(e(f).Tr,{key:0},{default:i(()=>[r(e(f).Td,{colspan:"7",class:"py-10 text-center text-slate-500"},{default:i(()=>[u("div",ht,[r(e(C),{icon:"Inbox",class:"w-10 h-10 text-slate-300"}),u("div",null,d(e(a)("schedules.empty")),1)])]),_:1})]),_:1})):k("",!0),(c(!0),_(F,null,M(q.value,(s,o)=>(c(),$(e(f).Tr,{key:s.id,class:b(["[&_td]:last:border-b-0",V(s.course_id),Cs(s.course_id,o)?"border-t-2 border-t-slate-300 dark:border-t-slate-600":""])},{default:i(()=>[r(e(f).Td,{class:b(["py-4 border-dashed transition-colors",V(s.course_id)])},{default:i(()=>[u("div",mt,"#"+d(s.id),1)]),_:2},1032,["class"]),r(e(f).Td,{class:b(["py-4 border-dashed transition-colors",V(s.course_id)])},{default:i(()=>[ws(s.course_id,o)?(c(),_("div",pt,d(s.course.name),1)):(c(),_("div",ft," â€” "))]),_:2},1032,["class"]),r(e(f).Td,{class:b(["py-4 border-dashed transition-colors",V(s.course_id)])},{default:i(()=>[u("div",yt,d(s.teacher.name),1)]),_:2},1032,["class"]),r(e(f).Td,{class:b(["py-4 border-dashed transition-colors",V(s.course_id)])},{default:i(()=>[u("div",gt,d(rs(s.day_of_week)),1)]),_:2},1032,["class"]),r(e(f).Td,{class:b(["py-4 border-dashed transition-colors",V(s.course_id)])},{default:i(()=>[u("div",kt,d(s.starts_at),1)]),_:2},1032,["class"]),r(e(f).Td,{class:b(["py-4 border-dashed transition-colors",V(s.course_id)])},{default:i(()=>[u("div",bt,d(s.ends_at),1)]),_:2},1032,["class"]),r(e(f).Td,{class:b(["py-4 border-dashed transition-colors",V(s.course_id)])},{default:i(()=>[u("div",xt,d(s.description),1)]),_:2},1032,["class"]),r(e(f).Td,{class:b(["relative py-4 border-dashed transition-colors",V(s.course_id)])},{default:i(()=>[u("div",wt,[r(e(T),{variant:"outline-primary",size:"sm",onClick:m=>hs(s),class:"w-16"},{default:i(()=>[r(e(C),{icon:"Pencil",class:"w-3.5 h-3.5 mr-1"}),h(" "+d(e(a)("schedules.actions.edit")),1)]),_:2},1032,["onClick"]),r(e(T),{variant:"outline-danger",size:"sm",onClick:m=>fs(s),class:"w-20"},{default:i(()=>[r(e(C),{icon:"Trash2",class:"w-3.5 h-3.5 mr-1"}),h(" "+d(e(a)("schedules.actions.delete")),1)]),_:2},1032,["onClick"]),xs(s,o)?(c(),$(e(T),{key:0,variant:"outline-secondary",size:"sm",onClick:m=>ms(s),class:"w-24"},{default:i(()=>[r(e(C),{icon:"List",class:"w-3.5 h-3.5 mr-1"}),h(" "+d(e(a)("schedules.actions.manage")),1)]),_:2},1032,["onClick"])):(c(),_("div",Ct))])]),_:2},1032,["class"])]),_:2},1032,["class"]))),128))]),_:1})]),_:1})])),!e(Se)&&!e(Te)&&K.value>0?(c(),_("div",St,[u("div",Tt,[u("span",$t,d(e(a)("schedules.pagination.show")),1),Es(u("select",{"onUpdate:modelValue":l[7]||(l[7]=s=>O.value=s),onChange:l[8]||(l[8]=s=>gs(O.value)),class:"px-3 py-2 text-sm border rounded-md border-slate-300 dark:border-darkmode-400 dark:bg-darkmode-800 focus:ring-2 focus:ring-primary focus:border-primary"},Dt,544),[[Is,O.value,void 0,{number:!0}]]),u("span",Vt,d(e(a)("schedules.pagination.entries")),1)]),u("div",Pt,d(e(a)("schedules.pagination.showingInfo",{start:os.value,end:ds.value,total:K.value})),1),r(e(B),{class:"flex-1 sm:flex-initial"},{default:i(()=>[r(e(B).Link,{onClick:l[9]||(l[9]=s=>le(g.value-1)),class:b({"cursor-not-allowed opacity-50":g.value===1})},{default:i(()=>[r(e(C),{icon:"ChevronLeft",class:"w-4 h-4"})]),_:1},8,["class"]),D.value>0?(c(),$(e(B).Link,{key:0,active:g.value===1,onClick:l[10]||(l[10]=s=>le(1))},{default:i(()=>[h(" 1 ")]),_:1},8,["active"])):k("",!0),g.value>3?(c(),$(e(B).Link,{key:1,disabled:""},{default:i(()=>[h(" ... ")]),_:1})):k("",!0),(c(!0),_(F,null,M(D.value,s=>(c(),_(F,{key:s},[s>1&&s<D.value&&Math.abs(s-g.value)<=1?(c(),$(e(B).Link,{key:0,active:g.value===s,onClick:o=>le(s)},{default:i(()=>[h(d(s),1)]),_:2},1032,["active","onClick"])):k("",!0)],64))),128)),g.value<D.value-2?(c(),$(e(B).Link,{key:2,disabled:""},{default:i(()=>[h(" ... ")]),_:1})):k("",!0),D.value>1?(c(),$(e(B).Link,{key:3,active:g.value===D.value,onClick:l[11]||(l[11]=s=>le(D.value))},{default:i(()=>[h(d(D.value),1)]),_:1},8,["active"])):k("",!0),r(e(B).Link,{onClick:l[12]||(l[12]=s=>le(g.value+1)),class:b({"cursor-not-allowed opacity-50":g.value===D.value})},{default:i(()=>[r(e(C),{icon:"ChevronRight",class:"w-4 h-4"})]),_:1},8,["class"])]),_:1})])):k("",!0)]),r(e(H),{open:ae.value,onClose:ge,staticBackdrop:!0},{default:i(()=>[r(e(H).Panel,{class:"max-w-3xl sm:w-[540px]"},{default:i(()=>[r(e(H).Title,null,{default:i(()=>[u("h2",Ft,d(ls.value),1)]),_:1}),r(e(H).Description,{class:"grid grid-cols-12 gap-4 gap-y-3"},{default:i(()=>[u("div",At,[r(e(Q),{htmlFor:"schedule-course"},{default:i(()=>[h(d(e(a)("schedules.form.course"))+" *",1)]),_:1}),r(e(_e),{id:"schedule-course",modelValue:n.value.course_id,"onUpdate:modelValue":l[13]||(l[13]=s=>n.value.course_id=s),disabled:A.value||I.value||e(ee),class:b({"border-danger":v.value.course_id})},{default:i(()=>[u("option",Nt,d(e(a)("schedules.form.selectCourse")),1),(c(!0),_(F,null,M(ue.value,s=>(c(),_("option",{key:s.id,value:s.id},d(s.name),9,Mt))),128))]),_:1},8,["modelValue","disabled","class"]),v.value.course_id?(c(),_("div",Bt,d(v.value.course_id),1)):k("",!0)]),u("div",Ot,[r(e(Q),{htmlFor:"schedule-description"},{default:i(()=>[h(d(e(a)("schedules.form.description"))+" *",1)]),_:1}),r(e(te),{id:"schedule-description",modelValue:n.value.description,"onUpdate:modelValue":l[14]||(l[14]=s=>n.value.description=s),type:"text",placeholder:e(a)("schedules.form.descriptionPlaceholder"),disabled:e(ee),class:b({"border-danger":v.value.description})},null,8,["modelValue","placeholder","disabled","class"]),v.value.description?(c(),_("div",Gt,d(v.value.description),1)):k("",!0)]),e(ee)?(c(),_("div",jt,[u("div",qt,[r(e(C),{icon:"Loader",class:"w-6 h-6 animate-spin text-primary"}),u("div",zt,d(e(a)("schedules.messages.loadingSchedules")),1)])])):k("",!0),e(ee)?k("",!0):(c(),_("div",Rt,[u("div",Ht,[r(e(Q),{class:"mb-0"},{default:i(()=>[h(d(e(a)("schedules.form.scheduleSlots")),1)]),_:1})]),u("div",Qt,[(c(!0),_(F,null,M(n.value.schedules,(s,o)=>{var m,S,U,x,y,L,N,z,Ie,Ue,Le,De,Ve,Pe,Fe,Ae;return c(),_("div",{key:o,class:"p-4 border-2 border-slate-200 rounded-lg dark:border-darkmode-400 bg-white dark:bg-darkmode-800 shadow-sm"},[u("div",Wt,[u("div",Kt,[u("div",Yt,d(o+1),1),u("div",Jt,d(e(a)("schedules.form.slot",{number:o+1})),1)]),!I.value&&n.value.schedules.length>1?(c(),$(e(T),{key:0,type:"button",variant:"soft-danger",size:"sm",onClick:w=>ns(o),class:"px-3"},{default:i(()=>[r(e(C),{icon:"Trash2",class:"w-3.5 h-3.5 mr-1.5"}),h(" "+d(e(a)("schedules.actions.removeSlot")),1)]),_:2},1032,["onClick"])):k("",!0)]),u("div",Xt,[u("div",Zt,[r(e(Q),{htmlFor:`slot-teacher-${o}`},{default:i(()=>[h(d(e(a)("schedules.form.teacher"))+" * ",1)]),_:2},1032,["htmlFor"]),r(e(_e),{id:`slot-teacher-${o}`,modelValue:s.teacher_id,"onUpdate:modelValue":w=>s.teacher_id=w,class:b({"border-danger":(S=(m=v.value.schedules)==null?void 0:m[o])==null?void 0:S.teacher_id})},{default:i(()=>[u("option",ea,d(e(a)("schedules.form.selectTeacher")),1),(c(!0),_(F,null,M(ve.value,w=>(c(),_("option",{key:w.id,value:w.id},d(w.name),9,sa))),128))]),_:2},1032,["id","modelValue","onUpdate:modelValue","class"]),(x=(U=v.value.schedules)==null?void 0:U[o])!=null&&x.teacher_id?(c(),_("div",ta,d(v.value.schedules[o].teacher_id),1)):k("",!0)]),u("div",aa,[r(e(Q),{htmlFor:`slot-day-${o}`},{default:i(()=>[h(d(e(a)("schedules.form.dayOfWeek"))+" *",1)]),_:2},1032,["htmlFor"]),r(e(_e),{id:`slot-day-${o}`,modelValue:s.day_of_week,"onUpdate:modelValue":w=>s.day_of_week=w,class:b({"border-danger":(L=(y=v.value.schedules)==null?void 0:y[o])==null?void 0:L.day_of_week})},{default:i(()=>[u("option",la,d(e(a)("schedules.form.selectDay")),1),(c(!0),_(F,null,M(us.value,w=>(c(),_("option",{key:w.value,value:w.value},d(w.label),9,oa))),128))]),_:2},1032,["id","modelValue","onUpdate:modelValue","class"]),(z=(N=v.value.schedules)==null?void 0:N[o])!=null&&z.day_of_week?(c(),_("div",da,d(v.value.schedules[o].day_of_week),1)):k("",!0)]),u("div",ra,[r(e(Q),{htmlFor:`slot-start-${o}`},{default:i(()=>[h(d(e(a)("schedules.form.startsAt"))+" *",1)]),_:2},1032,["htmlFor"]),r(e(te),{id:`slot-start-${o}`,modelValue:s.starts_at,"onUpdate:modelValue":w=>s.starts_at=w,type:"time",class:b({"border-danger":(Ue=(Ie=v.value.schedules)==null?void 0:Ie[o])==null?void 0:Ue.starts_at})},null,8,["id","modelValue","onUpdate:modelValue","class"]),(De=(Le=v.value.schedules)==null?void 0:Le[o])!=null&&De.starts_at?(c(),_("div",ua,d(v.value.schedules[o].starts_at),1)):k("",!0)]),u("div",ia,[r(e(Q),{htmlFor:`slot-end-${o}`},{default:i(()=>[h(d(e(a)("schedules.form.endsAt"))+" *",1)]),_:2},1032,["htmlFor"]),r(e(te),{id:`slot-end-${o}`,modelValue:s.ends_at,"onUpdate:modelValue":w=>s.ends_at=w,type:"time",class:b({"border-danger":(Pe=(Ve=v.value.schedules)==null?void 0:Ve[o])==null?void 0:Pe.ends_at})},null,8,["id","modelValue","onUpdate:modelValue","class"]),(Ae=(Fe=v.value.schedules)==null?void 0:Fe[o])!=null&&Ae.ends_at?(c(),_("div",ca,d(v.value.schedules[o].ends_at),1)):k("",!0)])])])}),128))]),I.value?k("",!0):(c(),_("div",na,[r(e(T),{type:"button",variant:"outline-primary",size:"sm",onClick:cs,class:"w-full"},{default:i(()=>[r(e(C),{icon:"Plus",class:"w-4 h-4 mr-2"}),h(" "+d(e(a)("schedules.actions.addSlot")),1)]),_:1})]))]))]),_:1}),r(e(H).Footer,{class:"text-right"},{default:i(()=>[r(e(T),{type:"button",variant:"outline-secondary",onClick:ge,disabled:ye.value||e(ee),class:"min-w-28 mr-2"},{default:i(()=>[h(d(e(a)("schedules.actions.cancel")),1)]),_:1},8,["disabled"]),r(e(T),{type:"button",variant:"primary",onClick:ps,disabled:ye.value||e(ee),class:"min-w-44"},{default:i(()=>[ye.value?(c(),$(e(C),{key:0,icon:"Loader",class:"w-4 h-4 animate-spin"})):I.value?(c(),_("span",_a,d(e(a)("schedules.actions.update")),1)):A.value?(c(),_("span",va,d(e(a)("schedules.actions.updateAll")),1)):(c(),_("span",ha,d(e(a)("schedules.actions.createAll")),1))]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),r(e(H),{open:ie.value,onClose:Ee,staticBackdrop:!0},{default:i(()=>[r(e(H).Panel,null,{default:i(()=>{var s,o;return[u("div",ma,[r(e(C),{icon:"AlertTriangle",class:"w-16 h-16 mx-auto mt-3 text-danger"}),u("div",pa,d(e(a)("schedules.delete.title")),1),u("div",fa,[h(d(e(a)("schedules.delete.message",{course:((o=(s=W.value)==null?void 0:s.course)==null?void 0:o.name)||""}))+" ",1),ya,h(" "+d(e(a)("schedules.delete.cannotUndo")),1)])]),u("div",ga,[r(e(T),{type:"button",variant:"outline-secondary",onClick:Ee,disabled:e(fe),class:"w-24 mr-2"},{default:i(()=>[h(d(e(a)("schedules.delete.cancel")),1)]),_:1},8,["disabled"]),r(e(T),{type:"button",variant:"danger",onClick:ys,disabled:e(fe),class:"w-24"},{default:i(()=>[e(fe)?(c(),$(e(C),{key:0,icon:"Loader",class:"w-4 h-4 animate-spin"})):(c(),_("span",ka,d(e(a)("schedules.delete.confirm")),1))]),_:1},8,["disabled"])])]}),_:1})]),_:1},8,["open"]),r(Us,{show:me.value,message:we.value,type:Ce.value,onClose:is},null,8,["show","message","type"])]))}}),$a=Vs(ba,[["__scopeId","data-v-0b5c0419"]]);export{$a as default};
