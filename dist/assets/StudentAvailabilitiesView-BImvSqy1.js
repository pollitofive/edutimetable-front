import{d as ot,Y as ut,Z as F,r as b,$ as re,a0 as te,c as N,N as ae,i as v,o as r,k as o,j as d,x as i,e,w as u,B as m,n as h,E as w,v as g,F as B,p as R,a as S,s as T,I as rt,a1 as ct,a2 as O,C as Te,a4 as vt,a5 as _t,a6 as mt,a7 as ft}from"./index-D2oXT1xy.js";import{_ as K}from"./FormLabel.vue_vue_type_script_setup_true_lang-DPKPgNkB.js";import{_ as Ie}from"./FormSelect.vue_vue_type_script_setup_true_lang-B1PIZPoQ.js";import{T as k,P as M}from"./index-CBE7LNRt.js";import{_ as Ce}from"./TomSelect.vue_vue_type_script_setup_true_lang-BO1vyfpz.js";const X=Z=>(_t("data-v-47443819"),Z=Z(),mt(),Z),bt={class:"flex flex-col gap-y-3 md:h-10 md:flex-row md:items-center"},pt={class:"text-base font-medium"},yt={class:"flex flex-col gap-x-3 gap-y-2 sm:flex-row md:ml-auto"},kt={class:"box box--stacked flex flex-col mt-5"},ht={class:"p-5 border-b border-slate-200/60"},gt={class:"flex flex-col gap-4 sm:flex-row sm:items-center"},At={class:"flex-1"},xt={value:""},wt=["value"],St={class:"flex-1"},Tt={value:""},It={value:"0"},Ct={value:"1"},$t={value:"2"},Et={value:"3"},Lt={value:"4"},Dt={value:"5"},Ut={value:"6"},Pt={key:0,class:"flex items-center justify-center p-10"},Nt={class:"flex flex-col items-center gap-3"},Bt={class:"text-sm text-slate-500"},Mt={key:1,class:"flex items-center justify-center p-10"},Vt={class:"flex flex-col items-center gap-3"},Ft={class:"text-sm text-slate-500"},Ot={key:2,class:"overflow-x-auto"},jt={class:"flex flex-col items-center gap-3"},qt={key:0,class:"font-medium text-slate-700 dark:text-slate-200"},Rt={key:1,class:"text-slate-400 dark:text-slate-500 text-sm"},zt={class:"px-2 py-1 text-xs font-medium rounded-md bg-primary/10 text-primary inline-block"},Gt={class:"font-mono text-slate-600 dark:text-slate-300"},Qt={class:"font-mono text-slate-600 dark:text-slate-300"},Yt={class:"flex items-center justify-center gap-2"},Wt={key:1,class:"w-24"},Kt={key:3,class:"flex flex-col items-center gap-4 p-5 border-t sm:flex-row border-slate-200/60"},Xt={class:"flex items-center gap-2"},Zt={class:"text-sm text-slate-600"},Ht=X(()=>o("option",{value:10},"10",-1)),Jt=X(()=>o("option",{value:25},"25",-1)),ea=X(()=>o("option",{value:50},"50",-1)),ta=X(()=>o("option",{value:100},"100",-1)),aa=[Ht,Jt,ea,ta],sa={class:"text-sm text-slate-600"},ia={class:"text-sm text-slate-600 sm:ml-auto"},la={class:"mr-auto text-base font-medium"},da={class:"col-span-12"},na={value:""},oa=["value"],ua={key:0,class:"mt-1 text-xs text-danger"},ra={key:0,class:"col-span-12 flex items-center justify-center py-8"},ca={class:"flex flex-col items-center gap-3"},va={class:"text-sm text-slate-500"},_a={key:1,class:"col-span-12"},ma={class:"flex items-center justify-between mb-3"},fa={class:"max-h-80 overflow-y-auto pr-2 space-y-3 scroll-smooth border border-slate-200/60 rounded-lg p-3 dark:border-darkmode-400"},ba={class:"flex items-center justify-between mb-3"},pa={class:"flex items-center gap-2"},ya={class:"flex items-center justify-center w-7 h-7 rounded-full bg-primary/10 text-primary font-semibold text-sm"},ka={class:"text-sm font-medium text-slate-700 dark:text-slate-300"},ha={class:"grid grid-cols-12 gap-3"},ga={class:"col-span-12 sm:col-span-4"},Aa={value:""},xa=["value"],wa={key:0,class:"mt-1 text-xs text-danger"},Sa={class:"col-span-12 sm:col-span-4"},Ta={key:0,class:"mt-1 text-xs text-danger"},Ia={class:"col-span-12 sm:col-span-4"},Ca={key:0,class:"mt-1 text-xs text-danger"},$a={key:0,class:"mt-3"},Ea={key:1},La={key:2},Da={key:3},Ua={class:"p-5 text-center"},Pa={class:"mt-5 text-3xl"},Na={class:"mt-2 text-slate-500"},Ba=X(()=>o("br",null,null,-1)),Ma={class:"px-5 pb-8 text-center"},Va={key:1},Fa=ot({__name:"StudentAvailabilitiesView",setup(Z){const{t}=ut(),$e=F`
  query GetStudentAvailabilities($first: Int!, $page: Int!, $student_id: ID, $day_of_week: Int) {
    studentAvailabilities(first: $first, page: $page, student_id: $student_id, day_of_week: $day_of_week) {
      data {
        id
        student_id
        student {
          id
          name
        }
        day_of_week
        start_time
        end_time
      }
      paginatorInfo {
        total
        count
        currentPage
        lastPage
        hasMorePages
        perPage
      }
    }
  }
`,Ee=F`
  query GetAllStudents {
    students(first: 10000) {
      data {
        id
        name
      }
    }
  }
`,Le=F`
  query Me {
    me {
      id
      name
      email
    }
  }
`,De=F`
  mutation BulkCreateStudentAvailabilities($input: BulkCreateStudentAvailabilitiesInput!) {
    bulkCreateStudentAvailabilities(input: $input) {
      id
      student_id
      day_of_week
      start_time
      end_time
      student {
        id
        name
      }
    }
  }
`,Ue=F`
  mutation BulkUpdateStudentAvailabilities($input: BulkUpdateStudentAvailabilitiesInput!) {
    bulkUpdateStudentAvailabilities(input: $input) {
      id
      student_id
      day_of_week
      start_time
      end_time
      student {
        id
        name
      }
    }
  }
`,Pe=F`
  mutation UpdateStudentAvailability($id: ID!, $input: UpdateStudentAvailabilityInput!) {
    updateStudentAvailability(id: $id, input: $input) {
      id
      student_id
      day_of_week
      start_time
      end_time
      student {
        id
        name
      }
    }
  }
`,Ne=F`
  mutation DeleteStudentAvailability($id: ID!) {
    deleteStudentAvailability(id: $id) {
      id
    }
  }
`,se=b([]),z=b([]),G=b(!1),U=b(!1),L=b(!1),ie=b(null),_=b({student_id:"",availabilities:[{day_of_week:"",start_time:"",end_time:""}]}),f=b({}),H=b(!1),P=b(null),le=b(!1),ce=b(""),ve=b("success"),p=b(1),C=b(10),j=b(0),de=b(1),I=b(""),x=b(""),{result:J,loading:_e,error:me,refetch:Q}=re($e,()=>({first:C.value,page:p.value,student_id:I.value||void 0}),{fetchPolicy:"cache-and-network"}),{result:Be}=re(Ee);re(Le);const{mutate:Me,loading:Ve}=te(De),{mutate:Fe,loading:Oe}=te(Ue),{mutate:je,loading:qe}=te(Pe),{mutate:Re,loading:ne}=te(Ne),oe=N(()=>Ve.value||Oe.value||qe.value),ze=N(()=>{var s;if(L.value)return t("studentAvailabilities.form.editSingleTitle");if(U.value){const n=((s=z.value.find(a=>a.id===_.value.student_id))==null?void 0:s.name)||"";return t("studentAvailabilities.form.editTitle",{student:n})}return t("studentAvailabilities.form.addTitle")}),Ge=N(()=>j.value===0?0:(p.value-1)*C.value+1),Qe=N(()=>{const s=p.value*C.value;return s>j.value?j.value:s}),D=N(()=>de.value),fe=s=>[t("studentAvailabilities.days.sunday"),t("studentAvailabilities.days.monday"),t("studentAvailabilities.days.tuesday"),t("studentAvailabilities.days.wednesday"),t("studentAvailabilities.days.thursday"),t("studentAvailabilities.days.friday"),t("studentAvailabilities.days.saturday")][s]||"",Ye=N(()=>[{value:0,label:t("studentAvailabilities.days.sunday")},{value:1,label:t("studentAvailabilities.days.monday")},{value:2,label:t("studentAvailabilities.days.tuesday")},{value:3,label:t("studentAvailabilities.days.wednesday")},{value:4,label:t("studentAvailabilities.days.thursday")},{value:5,label:t("studentAvailabilities.days.friday")},{value:6,label:t("studentAvailabilities.days.saturday")}]);ae(J,s=>{var n,a;if((n=s==null?void 0:s.studentAvailabilities)!=null&&n.data&&(se.value=s.studentAvailabilities.data),(a=s==null?void 0:s.studentAvailabilities)!=null&&a.paginatorInfo){const l=s.studentAvailabilities.paginatorInfo;j.value=l.total,de.value=l.lastPage,p.value=l.currentPage}}),ae(Be,s=>{var n;(n=s==null?void 0:s.students)!=null&&n.data&&(z.value=[...s.students.data].sort((a,l)=>a.name.localeCompare(l.name)))},{immediate:!0});const V=b(!1),$=(s,n="success")=>{ce.value=s,ve.value=n,le.value=!0},We=()=>{le.value=!1},Ke=()=>{const s=_.value.availabilities.length>0?_.value.availabilities[_.value.availabilities.length-1]:null;s?_.value.availabilities.push({day_of_week:s.day_of_week,start_time:s.start_time,end_time:s.end_time}):_.value.availabilities.push({day_of_week:"",start_time:"",end_time:""})},Xe=s=>{_.value.availabilities.length>1&&(_.value.availabilities.splice(s,1),f.value.availabilities&&f.value.availabilities[s]&&f.value.availabilities.splice(s,1))},Ze=()=>{if(f.value={availabilities:[]},_.value.student_id||(f.value.student_id=t("studentAvailabilities.validation.studentRequired")),_.value.availabilities.length===0)return $(t("studentAvailabilities.validation.atLeastOneSlot"),"error"),!1;let s=!1;return _.value.availabilities.forEach((n,a)=>{const l={};n.day_of_week===""&&(l.day_of_week=t("studentAvailabilities.validation.dayRequired"),s=!0),(!n.start_time||!n.start_time.trim())&&(l.start_time=t("studentAvailabilities.validation.startTimeRequired"),s=!0),(!n.end_time||!n.end_time.trim())&&(l.end_time=t("studentAvailabilities.validation.endTimeRequired"),s=!0),n.start_time&&n.end_time&&n.end_time<=n.start_time&&(l.end_time=t("studentAvailabilities.validation.endTimeAfterStart"),s=!0),Object.keys(l).length>0&&(f.value.availabilities||(f.value.availabilities=[]),f.value.availabilities[a]=l)}),!s&&!f.value.student_id},He=()=>{U.value=!1,_.value={student_id:"",availabilities:[{day_of_week:"",start_time:"",end_time:""}]},f.value={},G.value=!0},Je=s=>{U.value=!1,L.value=!0,ie.value=s.id,_.value={student_id:s.student_id,availabilities:[{day_of_week:s.day_of_week,start_time:s.start_time,end_time:s.end_time}]},f.value={},G.value=!0},et=async s=>{var a,l;U.value=!0,L.value=!1;const n=s.student_id;I.value=n,_.value={student_id:n,availabilities:[]},f.value={},G.value=!0,V.value=!0;try{const c=await Q({first:1e3,page:1,student_id:n});if((l=(a=c==null?void 0:c.data)==null?void 0:a.studentAvailabilities)!=null&&l.data){const y=c.data.studentAvailabilities.data;y.length>0?_.value.availabilities=y.map(A=>({day_of_week:A.day_of_week,start_time:A.start_time,end_time:A.end_time})):_.value.availabilities=[{day_of_week:"",start_time:"",end_time:""}]}}catch(c){console.error("Error loading student availabilities:",c),$(t("studentAvailabilities.messages.loadError")||"Error loading availabilities","error"),_.value.availabilities=[{day_of_week:"",start_time:"",end_time:""}]}finally{V.value=!1}},ue=()=>{G.value=!1,U.value=!1,L.value=!1,ie.value=null,_.value={student_id:"",availabilities:[{day_of_week:"",start_time:"",end_time:""}]},f.value={}},tt=async()=>{var n,a;if(!Ze())return;if(!localStorage.getItem("token")){$("You are not logged in. Please login first.","error");return}try{if(L.value){const l=_.value.availabilities[0],c={student_id:_.value.student_id,day_of_week:Number(l.day_of_week),start_time:l.start_time,end_time:l.end_time};await je({id:ie.value,input:c}),$(t("studentAvailabilities.messages.updateSingleSuccess"),"success")}else if(U.value){const l={student_id:_.value.student_id,availabilities:_.value.availabilities.map(c=>({day_of_week:Number(c.day_of_week),start_time:c.start_time,end_time:c.end_time}))};await Fe({input:l}),$(t("studentAvailabilities.messages.updateSuccess"),"success")}else{const l={student_id:_.value.student_id,availabilities:_.value.availabilities.map(c=>({day_of_week:Number(c.day_of_week),start_time:c.start_time,end_time:c.end_time}))};await Me({input:l}),$(t("studentAvailabilities.messages.createSuccess"),"success")}ue(),W()}catch(l){if(l.graphQLErrors&&l.graphQLErrors.length>0){const y=l.graphQLErrors[0];if(((n=y.extensions)==null?void 0:n.category)==="validation"){const A=(a=y.extensions)==null?void 0:a.validation,ee=Object.values(A).flat().join(", ");$(`Validation Error: ${ee}`,"error");return}}const c=l.message||t("studentAvailabilities.messages.generalError");$(c,"error")}},at=s=>{P.value=s,H.value=!0},st=async()=>{if(P.value)try{await Re({id:P.value.id}),$(t("studentAvailabilities.messages.deleteSuccess"),"success"),H.value=!1,P.value=null,W()}catch(s){const n=s.message||t("studentAvailabilities.messages.deleteError");$(n,"error")}},be=()=>{H.value=!1,P.value=null},Y=s=>{s>=1&&s<=de.value&&(p.value=s,Q({first:C.value,page:s,student_id:I.value||void 0,day_of_week:x.value?Number(x.value):void 0}))},it=s=>{C.value=s,p.value=1,Q({first:s,page:1,student_id:I.value||void 0,day_of_week:x.value?Number(x.value):void 0})},W=()=>{p.value=1,Q({first:C.value,page:1,student_id:I.value||void 0,day_of_week:x.value?Number(x.value):void 0})},lt=()=>{I.value="",x.value="",W()},dt=N(()=>I.value!==""||x.value!=="");ae(I,()=>{W()}),ae(x,()=>{W()}),N(()=>{var s;return((s=z.value.find(n=>n.id===_.value.student_id))==null?void 0:s.name)||""});const pe=(s,n)=>{var c,y;const l=(((y=(c=J.value)==null?void 0:c.studentAvailabilities)==null?void 0:y.data)||[]).findIndex(A=>A.student_id===s);return n===l},nt=(s,n)=>{var c,y,A;return n===0?!0:((A=(((y=(c=J.value)==null?void 0:c.studentAvailabilities)==null?void 0:y.data)||[])[n-1])==null?void 0:A.student_id)!==s},q=s=>{var c,y;const n=((y=(c=J.value)==null?void 0:c.studentAvailabilities)==null?void 0:y.data)||[];return[...new Set(n.map(A=>A.student_id))].indexOf(s)%2===0?"bg-white dark:bg-darkmode-600":"bg-slate-50/50 dark:bg-darkmode-700"};return(s,n)=>(r(),v(B,null,[o("div",bt,[o("div",pt,i(e(t)("studentAvailabilities.title")),1),o("div",yt,[d(e(w),{variant:"primary",onClick:He},{default:u(()=>[d(e(h),{icon:"Plus",class:"w-4 h-4 mr-2"}),m(" "+i(e(t)("studentAvailabilities.newAvailability")),1)]),_:1})])]),o("div",kt,[o("div",ht,[o("div",gt,[o("div",At,[d(e(Ce),{modelValue:I.value,"onUpdate:modelValue":n[0]||(n[0]=a=>I.value=a),options:{placeholder:e(t)("studentAvailabilities.filters.allStudents"),maxOptions:null,maxItems:1},class:"w-full"},{default:u(()=>[o("option",xt,i(e(t)("studentAvailabilities.filters.allStudents")),1),(r(!0),v(B,null,R(z.value,a=>(r(),v("option",{key:a.id,value:a.id},i(a.name),9,wt))),128))]),_:1},8,["modelValue","options"])]),o("div",St,[d(e(Ie),{modelValue:x.value,"onUpdate:modelValue":n[1]||(n[1]=a=>x.value=a)},{default:u(()=>[o("option",Tt,i(e(t)("studentAvailabilities.filters.allDays")),1),o("option",It,i(e(t)("studentAvailabilities.days.sunday")),1),o("option",Ct,i(e(t)("studentAvailabilities.days.monday")),1),o("option",$t,i(e(t)("studentAvailabilities.days.tuesday")),1),o("option",Et,i(e(t)("studentAvailabilities.days.wednesday")),1),o("option",Lt,i(e(t)("studentAvailabilities.days.thursday")),1),o("option",Dt,i(e(t)("studentAvailabilities.days.friday")),1),o("option",Ut,i(e(t)("studentAvailabilities.days.saturday")),1)]),_:1},8,["modelValue"])]),o("div",null,[dt.value?(r(),S(e(w),{key:0,variant:"outline-secondary",onClick:lt,class:"w-full sm:w-auto"},{default:u(()=>[d(e(h),{icon:"X",class:"w-4 h-4 mr-2"}),m(" "+i(e(t)("studentAvailabilities.actions.clearFilters")),1)]),_:1})):g("",!0)])])]),e(_e)?(r(),v("div",Pt,[o("div",Nt,[d(e(h),{icon:"Loader",class:"w-8 h-8 animate-spin text-primary"}),o("div",Bt,i(e(t)("studentAvailabilities.messages.loading")),1)])])):e(me)?(r(),v("div",Mt,[o("div",Vt,[d(e(h),{icon:"AlertCircle",class:"w-8 h-8 text-danger"}),o("div",Ft,i(e(t)("studentAvailabilities.messages.error")),1),d(e(w),{variant:"outline-primary",onClick:n[2]||(n[2]=()=>e(Q)({first:C.value,page:p.value,student_id:I.value||void 0,day_of_week:x.value?Number(x.value):void 0}))},{default:u(()=>[m(i(e(t)("studentAvailabilities.actions.retry")),1)]),_:1})])])):(r(),v("div",Ot,[d(e(k),{class:"border-b border-slate-200/60"},{default:u(()=>[d(e(k).Thead,null,{default:u(()=>[d(e(k).Tr,null,{default:u(()=>[d(e(k).Td,{class:"py-4 font-medium bg-slate-50 dark:bg-darkmode-800 text-slate-500 border-slate-200/60 whitespace-nowrap"},{default:u(()=>[m(i(e(t)("studentAvailabilities.columns.student")),1)]),_:1}),d(e(k).Td,{class:"py-4 font-medium bg-slate-50 dark:bg-darkmode-800 text-slate-500 border-slate-200/60 whitespace-nowrap"},{default:u(()=>[m(i(e(t)("studentAvailabilities.columns.dayOfWeek")),1)]),_:1}),d(e(k).Td,{class:"py-4 font-medium bg-slate-50 dark:bg-darkmode-800 text-slate-500 border-slate-200/60 whitespace-nowrap"},{default:u(()=>[m(i(e(t)("studentAvailabilities.columns.startTime")),1)]),_:1}),d(e(k).Td,{class:"py-4 font-medium bg-slate-50 dark:bg-darkmode-800 text-slate-500 border-slate-200/60 whitespace-nowrap"},{default:u(()=>[m(i(e(t)("studentAvailabilities.columns.endTime")),1)]),_:1}),d(e(k).Td,{class:"py-4 font-medium text-center bg-slate-50 dark:bg-darkmode-800 text-slate-500 border-slate-200/60 whitespace-nowrap"},{default:u(()=>[m(i(e(t)("studentAvailabilities.columns.actions")),1)]),_:1})]),_:1})]),_:1}),d(e(k).Tbody,null,{default:u(()=>[se.value.length===0?(r(),S(e(k).Tr,{key:0},{default:u(()=>[d(e(k).Td,{colspan:"6",class:"py-10 text-center text-slate-500"},{default:u(()=>[o("div",jt,[d(e(h),{icon:"Inbox",class:"w-10 h-10 text-slate-300"}),o("div",null,i(e(t)("studentAvailabilities.messages.noAvailabilities")),1)])]),_:1})]),_:1})):g("",!0),(r(!0),v(B,null,R(se.value,(a,l)=>(r(),S(e(k).Tr,{key:a.id,class:T(["[&_td]:last:border-b-0",q(a.student_id),nt(a.student_id,l)?"border-t-2 border-t-slate-300 dark:border-t-slate-600":""])},{default:u(()=>[d(e(k).Td,{class:T(["py-4 border-dashed transition-colors",q(a.student_id)])},{default:u(()=>[pe(a.student_id,l)?(r(),v("div",qt,i(a.student.name),1)):(r(),v("div",Rt," â€” "))]),_:2},1032,["class"]),d(e(k).Td,{class:T(["py-4 border-dashed transition-colors",q(a.student_id)])},{default:u(()=>[o("div",zt,i(fe(a.day_of_week)),1)]),_:2},1032,["class"]),d(e(k).Td,{class:T(["py-4 border-dashed transition-colors",q(a.student_id)])},{default:u(()=>[o("div",Gt,i(a.start_time),1)]),_:2},1032,["class"]),d(e(k).Td,{class:T(["py-4 border-dashed transition-colors",q(a.student_id)])},{default:u(()=>[o("div",Qt,i(a.end_time),1)]),_:2},1032,["class"]),d(e(k).Td,{class:T(["relative py-4 border-dashed transition-colors",q(a.student_id)])},{default:u(()=>[o("div",Yt,[d(e(w),{variant:"outline-primary",size:"sm",onClick:c=>Je(a),class:"w-16"},{default:u(()=>[d(e(h),{icon:"Pencil",class:"w-3.5 h-3.5 mr-1"}),m(" "+i(e(t)("studentAvailabilities.actions.edit")),1)]),_:2},1032,["onClick"]),d(e(w),{variant:"outline-danger",size:"sm",onClick:c=>at(a),class:"w-20"},{default:u(()=>[d(e(h),{icon:"Trash2",class:"w-3.5 h-3.5 mr-1"}),m(" "+i(e(t)("studentAvailabilities.actions.delete")),1)]),_:2},1032,["onClick"]),pe(a.student_id,l)?(r(),S(e(w),{key:0,variant:"outline-secondary",size:"sm",onClick:c=>et(a),class:"w-24"},{default:u(()=>[d(e(h),{icon:"List",class:"w-3.5 h-3.5 mr-1"}),m(" "+i(e(t)("studentAvailabilities.actions.manage")),1)]),_:2},1032,["onClick"])):(r(),v("div",Wt))])]),_:2},1032,["class"])]),_:2},1032,["class"]))),128))]),_:1})]),_:1})])),!e(_e)&&!e(me)&&j.value>0?(r(),v("div",Kt,[o("div",Xt,[o("span",Zt,i(e(t)("studentAvailabilities.pagination.show")),1),rt(o("select",{"onUpdate:modelValue":n[3]||(n[3]=a=>C.value=a),onChange:n[4]||(n[4]=a=>it(C.value)),class:"px-3 py-2 text-sm border rounded-md border-slate-300 dark:border-darkmode-400 dark:bg-darkmode-800 focus:ring-2 focus:ring-primary focus:border-primary"},aa,544),[[ct,C.value,void 0,{number:!0}]]),o("span",sa,i(e(t)("studentAvailabilities.pagination.entries")),1)]),o("div",ia,i(e(t)("studentAvailabilities.pagination.showingInfo",{start:Ge.value,end:Qe.value,total:j.value})),1),d(e(M),{class:"flex-1 sm:flex-initial"},{default:u(()=>[d(e(M).Link,{onClick:n[5]||(n[5]=a=>Y(p.value-1)),class:T({"cursor-not-allowed opacity-50":p.value===1})},{default:u(()=>[d(e(h),{icon:"ChevronLeft",class:"w-4 h-4"})]),_:1},8,["class"]),D.value>0?(r(),S(e(M).Link,{key:0,active:p.value===1,onClick:n[6]||(n[6]=a=>Y(1))},{default:u(()=>[m(" 1 ")]),_:1},8,["active"])):g("",!0),p.value>3?(r(),S(e(M).Link,{key:1,disabled:""},{default:u(()=>[m(" ... ")]),_:1})):g("",!0),(r(!0),v(B,null,R(D.value,a=>(r(),v(B,{key:a},[a>1&&a<D.value&&Math.abs(a-p.value)<=1?(r(),S(e(M).Link,{key:0,active:p.value===a,onClick:l=>Y(a)},{default:u(()=>[m(i(a),1)]),_:2},1032,["active","onClick"])):g("",!0)],64))),128)),p.value<D.value-2?(r(),S(e(M).Link,{key:2,disabled:""},{default:u(()=>[m(" ... ")]),_:1})):g("",!0),D.value>1?(r(),S(e(M).Link,{key:3,active:p.value===D.value,onClick:n[7]||(n[7]=a=>Y(D.value))},{default:u(()=>[m(i(D.value),1)]),_:1},8,["active"])):g("",!0),d(e(M).Link,{onClick:n[8]||(n[8]=a=>Y(p.value+1)),class:T({"cursor-not-allowed opacity-50":p.value===D.value})},{default:u(()=>[d(e(h),{icon:"ChevronRight",class:"w-4 h-4"})]),_:1},8,["class"])]),_:1})])):g("",!0)]),d(e(O),{open:G.value,onClose:ue,staticBackdrop:!0},{default:u(()=>[d(e(O).Panel,{class:"max-w-3xl sm:w-[540px]"},{default:u(()=>[d(e(O).Title,null,{default:u(()=>[o("h2",la,i(ze.value),1)]),_:1}),d(e(O).Description,{class:"grid grid-cols-12 gap-4 gap-y-3"},{default:u(()=>[o("div",da,[d(e(K),{htmlFor:"availability-student"},{default:u(()=>[m(i(e(t)("studentAvailabilities.form.student"))+" *",1)]),_:1}),d(e(Ce),{id:"availability-student",modelValue:_.value.student_id,"onUpdate:modelValue":n[9]||(n[9]=a=>_.value.student_id=a),disabled:U.value||L.value||V.value,options:{placeholder:e(t)("studentAvailabilities.form.selectStudent"),maxOptions:null,maxItems:1},class:T([{"border-danger":f.value.student_id},"w-full"])},{default:u(()=>[o("option",na,i(e(t)("studentAvailabilities.form.selectStudent")),1),(r(!0),v(B,null,R(z.value,a=>(r(),v("option",{key:a.id,value:a.id},i(a.name),9,oa))),128))]),_:1},8,["modelValue","disabled","options","class"]),f.value.student_id?(r(),v("div",ua,i(f.value.student_id),1)):g("",!0)]),V.value?(r(),v("div",ra,[o("div",ca,[d(e(h),{icon:"Loader",class:"w-6 h-6 animate-spin text-primary"}),o("div",va,i(e(t)("studentAvailabilities.messages.loadingAvailabilities")),1)])])):g("",!0),V.value?g("",!0):(r(),v("div",_a,[o("div",ma,[d(e(K),{class:"mb-0"},{default:u(()=>[m(i(e(t)("studentAvailabilities.form.availabilitySlots")),1)]),_:1})]),o("div",fa,[(r(!0),v(B,null,R(_.value.availabilities,(a,l)=>{var c,y,A,ee,ye,ke,he,ge,Ae,xe,we,Se;return r(),v("div",{key:l,class:"p-4 border-2 border-slate-200 rounded-lg dark:border-darkmode-400 bg-white dark:bg-darkmode-800 shadow-sm"},[o("div",ba,[o("div",pa,[o("div",ya,i(l+1),1),o("div",ka,i(e(t)("studentAvailabilities.form.slot",{number:l+1})),1)]),!L.value&&_.value.availabilities.length>1?(r(),S(e(w),{key:0,type:"button",variant:"soft-danger",size:"sm",onClick:E=>Xe(l),class:"px-3"},{default:u(()=>[d(e(h),{icon:"Trash2",class:"w-3.5 h-3.5 mr-1.5"}),m(" "+i(e(t)("studentAvailabilities.actions.removeSlot")),1)]),_:2},1032,["onClick"])):g("",!0)]),o("div",ha,[o("div",ga,[d(e(K),{htmlFor:`slot-day-${l}`},{default:u(()=>[m(i(e(t)("studentAvailabilities.form.dayOfWeek"))+" *",1)]),_:2},1032,["htmlFor"]),d(e(Ie),{id:`slot-day-${l}`,modelValue:a.day_of_week,"onUpdate:modelValue":E=>a.day_of_week=E,class:T({"border-danger":(y=(c=f.value.availabilities)==null?void 0:c[l])==null?void 0:y.day_of_week})},{default:u(()=>[o("option",Aa,i(e(t)("studentAvailabilities.form.selectDay")),1),(r(!0),v(B,null,R(Ye.value,E=>(r(),v("option",{key:E.value,value:E.value},i(E.label),9,xa))),128))]),_:2},1032,["id","modelValue","onUpdate:modelValue","class"]),(ee=(A=f.value.availabilities)==null?void 0:A[l])!=null&&ee.day_of_week?(r(),v("div",wa,i(f.value.availabilities[l].day_of_week),1)):g("",!0)]),o("div",Sa,[d(e(K),{htmlFor:`slot-start-${l}`},{default:u(()=>[m(i(e(t)("studentAvailabilities.form.startTime"))+" *",1)]),_:2},1032,["htmlFor"]),d(e(Te),{id:`slot-start-${l}`,modelValue:a.start_time,"onUpdate:modelValue":E=>a.start_time=E,type:"time",class:T({"border-danger":(ke=(ye=f.value.availabilities)==null?void 0:ye[l])==null?void 0:ke.start_time})},null,8,["id","modelValue","onUpdate:modelValue","class"]),(ge=(he=f.value.availabilities)==null?void 0:he[l])!=null&&ge.start_time?(r(),v("div",Ta,i(f.value.availabilities[l].start_time),1)):g("",!0)]),o("div",Ia,[d(e(K),{htmlFor:`slot-end-${l}`},{default:u(()=>[m(i(e(t)("studentAvailabilities.form.endTime"))+" *",1)]),_:2},1032,["htmlFor"]),d(e(Te),{id:`slot-end-${l}`,modelValue:a.end_time,"onUpdate:modelValue":E=>a.end_time=E,type:"time",class:T({"border-danger":(xe=(Ae=f.value.availabilities)==null?void 0:Ae[l])==null?void 0:xe.end_time})},null,8,["id","modelValue","onUpdate:modelValue","class"]),(Se=(we=f.value.availabilities)==null?void 0:we[l])!=null&&Se.end_time?(r(),v("div",Ca,i(f.value.availabilities[l].end_time),1)):g("",!0)])])])}),128))]),L.value?g("",!0):(r(),v("div",$a,[d(e(w),{type:"button",variant:"outline-primary",size:"sm",onClick:Ke,class:"w-full"},{default:u(()=>[d(e(h),{icon:"Plus",class:"w-4 h-4 mr-2"}),m(" "+i(e(t)("studentAvailabilities.actions.addSlot")),1)]),_:1})]))]))]),_:1}),d(e(O).Footer,{class:"text-right"},{default:u(()=>[d(e(w),{type:"button",variant:"outline-secondary",onClick:ue,disabled:oe.value||V.value,class:"min-w-28 mr-2"},{default:u(()=>[m(i(e(t)("studentAvailabilities.actions.cancel")),1)]),_:1},8,["disabled"]),d(e(w),{type:"button",variant:"primary",onClick:tt,disabled:oe.value||V.value,class:"min-w-44"},{default:u(()=>[oe.value?(r(),S(e(h),{key:0,icon:"Loader",class:"w-4 h-4 animate-spin"})):L.value?(r(),v("span",Ea,i(e(t)("studentAvailabilities.actions.update")),1)):U.value?(r(),v("span",La,i(e(t)("studentAvailabilities.actions.updateAll")),1)):(r(),v("span",Da,i(e(t)("studentAvailabilities.actions.createAll")),1))]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"]),d(e(O),{open:H.value,onClose:be,staticBackdrop:!0},{default:u(()=>[d(e(O).Panel,null,{default:u(()=>{var a,l;return[o("div",Ua,[d(e(h),{icon:"AlertTriangle",class:"w-16 h-16 mx-auto mt-3 text-danger"}),o("div",Pa,i(e(t)("studentAvailabilities.delete.confirmTitle")),1),o("div",Na,[m(i(e(t)("studentAvailabilities.delete.confirmMessage",{student:((l=(a=P.value)==null?void 0:a.student)==null?void 0:l.name)||"",day:P.value?fe(P.value.day_of_week):""}))+" ",1),Ba,m(" "+i(e(t)("studentAvailabilities.delete.cannotUndo")),1)])]),o("div",Ma,[d(e(w),{type:"button",variant:"outline-secondary",onClick:be,disabled:e(ne),class:"w-24 mr-2"},{default:u(()=>[m(i(e(t)("studentAvailabilities.actions.cancel")),1)]),_:1},8,["disabled"]),d(e(w),{type:"button",variant:"danger",onClick:st,disabled:e(ne),class:"w-24"},{default:u(()=>[e(ne)?(r(),S(e(h),{key:0,icon:"Loader",class:"w-4 h-4 animate-spin"})):(r(),v("span",Va,i(e(t)("studentAvailabilities.actions.delete")),1))]),_:1},8,["disabled"])])]}),_:1})]),_:1},8,["open"]),d(vt,{show:le.value,message:ce.value,type:ve.value,onClose:We},null,8,["show","message","type"])],64))}}),Ga=ft(Fa,[["__scopeId","data-v-47443819"]]);export{Ga as default};
